When creating Azure SQL Database Bicep templates:

1. **Use stable API versions** - Always use GA (generally available) API versions like `@2021-11-01` instead of preview versions like `@2023-05-01-preview`. Preview versions often lack complete type definitions in Bicep, causing validation errors.

2. **Use the `parent` property for child resources** - For child resources like databases, administrators, firewall rules, and authentication settings, use the `parent` property to establish the relationship:
   ```bicep
   resource database 'Microsoft.Sql/servers/databases@2021-11-01' = {
     parent: sqlServer
     name: 'DatabaseName'
     ...
   }

This is cleaner than using the concatenated name format '${sqlServer.name}/DatabaseName'.

Avoid unused parameters - Remove any parameters that are declared but not used in the template to prevent linter warnings.

API version consistency - Use the same stable API version across all related SQL resources (servers, databases, administrators, firewall rules, authentication) for consistency and compatibility.

Check type availability - If Bicep warns that a resource type "does not have types available", it's a sign you're using a preview API version. Switch to the latest stable version.

Also make sure to only use uniquestring() or uniqueString(resourceGroup().id) to create names for resources to deploy to azure and do not use md5sum ever.

Also make sure to include code in both the deploy.sh and deploy-with-chat.sh to add current IP to SQL Firewall and Allow Azure services access to SQL Server (if the script is run from Codespaces/ Azure container for example), here is example code:

# Add current IP to SQL firewall
echo "Adding current IP to SQL firewall..."
MY_IP=$(curl -s https://api.ipify.org)
SQL_SERVER_NAME=$(echo $SQL_SERVER_FQDN | cut -d'.' -f1)

# Allow Azure services access
echo "Allowing Azure services access to SQL Server..."
az sql server firewall-rule create \
    --resource-group $RESOURCE_GROUP \
    --server $SQL_SERVER_NAME \
    --name "AllowAllAzureIPs" \
    --start-ip-address 0.0.0.0 \
    --end-ip-address 0.0.0.0 \
    --output none

# Add deployment IP
az sql server firewall-rule create \
    --resource-group $RESOURCE_GROUP \
    --server $SQL_SERVER_NAME \
    --name "AllowDeploymentIP" \
    --start-ip-address $MY_IP \
    --end-ip-address $MY_IP \
    --output none

echo "Waiting additional 15 seconds for firewall rules to propagate..."
